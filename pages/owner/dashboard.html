<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/dormies/assets/logo-sm.png" />
    <title>Owner - Dashboard</title>
    <link rel="stylesheet" href="/dormies/styles/admin.css" />
    <link rel="stylesheet" href="/dormies/styles/owner/dashboard.css" />
    <script type="module" src="/dormies/js/admin.js"></script>
  </head>
  <body>
    <!-- Sidebar & Navbar Will Be Loaded Here -->
    <div id="sidebar-container"></div>

    <div id="main">
      <div class="main-content">
        <div>
          <h5>Good day!</h5>
          <h1><span id="owner_name"></span></h1>
        </div>

        <div class="main-list">
          <div class="title">
            <h3>Your Listings</h3>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        console.log("DOM Loaded. Fetching sidebar...");

        // Load sidebar and navbar dynamically
        fetch("/dormies/pages/owner.html")
          .then((response) => response.text())
          .then((data) => {
            let sidebarContainer = document.getElementById("sidebar-container");

            if (!sidebarContainer) {
              console.error("Error: #sidebar-container not found!");
              return;
            }

            sidebarContainer.innerHTML = data;

            // Run initialization AFTER inserting sidebar
            initializeSidebar();
          })
          .catch((error) => console.error("Error loading sidebar:", error));
      });

      function initializeSidebar() {
        console.log("Sidebar Loaded! Running initialization...");

        let menuBtn = document.getElementById("menu-btn");
        let accBtn = document.getElementById("acc_btn");

        if (menuBtn) {
          menuBtn.addEventListener("click", () => {
            document.getElementById("nav-list").classList.toggle("active");
          });
        }

        if (accBtn) {
          accBtn.addEventListener("click", () => {
            location.href = "/dormies/pages/owner/account.html";
          });
        }

        // Highlight active sidebar link
        let currentPage = window.location.pathname.split("/").pop();
        document.querySelectorAll(".nav-list-item").forEach((link) => {
          if (link.getAttribute("href").includes(currentPage)) {
            link.classList.add("active");
          }
        });

        // Fix logo path dynamically
        let logo = document.querySelector(".side-logo");
        if (logo) {
          logo.src = "/dormies/assets/logo-md.png";
          console.log("Logo updated:", logo.src);
        }

        let logoLoader = document.querySelector(".loader-img");
        if (logoLoader) {
          logoLoader.src = "/dormies/assets/logo-md.png";
          console.log("Logo updated:", logoLoader.src);
        }
      }
    </script>
  </body>
</html>
